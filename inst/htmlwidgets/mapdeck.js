(function () {
  'use strict';

  var HTMLWidgets$1 = window.HTMLWidgets;

  function initialise_map(el, x) {

    // call initial layers
    if (x.calls !== undefined) {

      console.log(x.calls);

      for (layerCalls = 0; layerCalls < x.calls.length; layerCalls++) {

        //push the map_id into the call.args
        x.calls[layerCalls].args.unshift(el.id);

        if (window[x.calls[layerCalls].functions]) {

          window[x.calls[layerCalls].functions].apply(window[el.id + 'map'], x.calls[layerCalls].args);
        }
      }
    }
  }

  // reference
  // https://www.youtube.com/watch?v=ICYLOZuFMz8

  // even if i 'import' everything, if I dno't use the function, it doesn't get imported
  // because of rollup's 'tree shaking'

  // dependencies
  ///npm install --save-dev rollup-plugin-node-resolve rollup-plugin-commonjs
  // node-resolve, for resolving node modules
  // commonjs, for using common JS as node modules


  // rollup command
  // ./node_modules/.bin/rollup -c

  // babel rc
  // npm install --save-dev babel-preset-es2015-rollup

  HTMLWidgets$1.widget({

    name: 'mapdeck',
    type: 'output',

    factory: function factory(el, width, height) {

      // TODO: define shared variables for this instance
      return {

        renderValue: function renderValue(x) {

          // TODO(don't use window.params, or, check if they're already defined)
          console.log("renderValue");
          window.params = [];
          window.params.push({ 'map_id': el.id });

          window[el.id + 'layers'] = []; // keep track of layers for overlaying multiple
          // needs to be an array because .props takes an array of layers

          var mapDiv = document.getElementById(el.id);
          mapDiv.className = 'mapdeckmap';

          var tooltipdiv = document.createElement('div');
          tooltipdiv.id = 'tooltip';
          mapDiv.appendChild(tooltipdiv);

          // INITIAL VIEW
          window[el.id + 'INITIAL_VIEW_STATE'] = {
            longitude: x.location[0],
            latitude: x.location[1],
            zoom: x.zoom,
            pitch: x.pitch
          };

          var deckgl = new Deck({
            mapboxApiAccessToken: x.access_token,
            container: el.id,
            mapStyle: x.style,
            initialViewState: window[el.id + 'INITIAL_VIEW_STATE'],
            layers: []
            //onLayerHover: setTooltip
          });

          console.log(deckgl);

          window[el.id + 'map'] = deckgl;
          initialise_map(el, x);
        },

        resize: function resize(width, height) {

          // TODO: code to re-render the widget with a new size
        }

      };
    }
  });

  if (HTMLWidgets$1.shinyMode) {

    Shiny.addCustomMessageHandler("mapdeckmap-calls", function (data) {

      var id = data.id,
          // the div id of the map
      el = document.getElementById(id),
          map = el,
          call = [],
          i = 0;

      if (!map) {
        //console.log("Couldn't find map with id " + id);
        return;
      }

      for (i = 0; i < data.calls.length; i++) {

        call = data.calls[i];

        //push the mapId into the call.args
        call.args.unshift(id);

        if (call.dependencies) {
          Shiny.renderDependencies(call.dependencies);
        }

        if (window[call.method]) {
          window[call.method].apply(window[id + 'map'], call.args);
        }
      }
    });
  }

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwZGVjay5qcyIsInNvdXJjZXMiOlsiLi4vLi4vamF2YXNjcmlwdC9nbG9iYWwvaHRtbHdpZGdldHMuanMiLCIuLi8uLi9qYXZhc2NyaXB0L21vZHVsZXMvdXRpbGl0aWVzLmpzIiwiLi4vLi4vamF2YXNjcmlwdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB3aW5kb3cuSFRNTFdpZGdldHM7XG4iLCJcbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXNlX21hcChlbCwgeCkge1xuXG5cdC8vIGNhbGwgaW5pdGlhbCBsYXllcnNcbiAgaWYgKHguY2FsbHMgIT09IHVuZGVmaW5lZCkge1xuXG4gIFx0Y29uc29sZS5sb2coeC5jYWxscyk7XG5cbiAgICBmb3IgKGxheWVyQ2FsbHMgPSAwOyBsYXllckNhbGxzIDwgeC5jYWxscy5sZW5ndGg7IGxheWVyQ2FsbHMrKykge1xuXG4gICAgICAvL3B1c2ggdGhlIG1hcF9pZCBpbnRvIHRoZSBjYWxsLmFyZ3NcbiAgICAgIHguY2FsbHNbbGF5ZXJDYWxsc10uYXJncy51bnNoaWZ0KGVsLmlkKTtcblxuICAgICAgaWYgKHdpbmRvd1t4LmNhbGxzW2xheWVyQ2FsbHNdLmZ1bmN0aW9uc10pIHtcblxuICAgICAgICB3aW5kb3dbeC5jYWxsc1tsYXllckNhbGxzXS5mdW5jdGlvbnNdLmFwcGx5KHdpbmRvd1tlbC5pZCArICdtYXAnXSwgeC5jYWxsc1tsYXllckNhbGxzXS5hcmdzKTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIlVua25vd24gZnVuY3Rpb24gXCIgKyB4LmNhbGxzW2xheWVyQ2FsbHNdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZmluZE9iamVjdEVsZW1lbnRCeUtleShhcnJheSwga2V5LCB2YWx1ZSwgbGF5ZXJfZGF0YSApIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChhcnJheVtpXVtrZXldID09PSB2YWx1ZSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG4gIHJldHVybiAtMTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlX2xheWVyKCBtYXBfaWQsIGxheWVyX2lkLCBsYXllciApIHtcbiAgdmFyIGVsZW0gPSBmaW5kT2JqZWN0RWxlbWVudEJ5S2V5KCB3aW5kb3dbbWFwX2lkICsgJ21hcCddLnByb3BzLmxheWVycywgJ2lkJywgbGF5ZXJfaWQpO1xuICBpZiAoIGVsZW0gIT0gLTEgKSB7XG4gIFx0d2luZG93WyBtYXBfaWQgKyAnbGF5ZXJzJ11bZWxlbV0gPSBsYXllcjtcbiAgfSBlbHNlIHtcbiAgXHR3aW5kb3dbbWFwX2lkICsgJ2xheWVycyddLnB1c2goIGxheWVyICk7XG4gIH1cbiAgd2luZG93W21hcF9pZCArICdtYXAnXS5zZXRQcm9wcyh7IGxheWVyczogWy4uLndpbmRvd1ttYXBfaWQgKyAnbGF5ZXJzJ10gXSB9KTtcbn1cblxuXG4vKipcbiAqIGhleCB0byByZ2JcbiAqXG4gKiBDb252ZXJ0cyBoZXggY29sb3VycyB0byByZ2JcbiAqL1xuY29uc3QgaGV4VG9SZ2IgPSBoZXggPT5cbiAgaGV4LnJlcGxhY2UoL14jPyhbYS1mXFxkXSkoW2EtZlxcZF0pKFthLWZcXGRdKSQvaVxuICAgICAgICAgICAgICwobSwgciwgZywgYikgPT4gJyMnICsgciArIHIgKyBnICsgZyArIGIgKyBiKVxuICAgIC5zdWJzdHJpbmcoMSkubWF0Y2goLy57Mn0vZylcbiAgICAubWFwKHggPT4gcGFyc2VJbnQoeCwgMTYpKTtcblxuY29uc3QgaGV4VG9SR0JBID0gKGhleCwgYWxwaGEgPSAyNTUpID0+IHtcbiAgICBsZXQgcGFyc2VTdHJpbmcgPSBoZXg7XG4gICAgaWYgKGhleC5zdGFydHNXaXRoKCcjJykpIHtwYXJzZVN0cmluZyA9IGhleC5zbGljZSgxLCA3KTt9XG4gICAgaWYgKHBhcnNlU3RyaW5nLmxlbmd0aCAhPT0gNikge3JldHVybiBudWxsO31cbiAgICBjb25zdCByID0gcGFyc2VJbnQocGFyc2VTdHJpbmcuc2xpY2UoMCwgMiksIDE2KTtcbiAgICBjb25zdCBnID0gcGFyc2VJbnQocGFyc2VTdHJpbmcuc2xpY2UoMiwgNCksIDE2KTtcbiAgICBjb25zdCBiID0gcGFyc2VJbnQocGFyc2VTdHJpbmcuc2xpY2UoNCwgNiksIDE2KTtcbiAgICBpZiAoaXNOYU4ocikgfHwgaXNOYU4oZykgfHwgaXNOYU4oYikpIHtyZXR1cm4gbnVsbDt9XG4gICAgcmV0dXJuIFtyLCBnLCBiLCBhbHBoYV07XG4gICAgLy9yZXR1cm4gYHJnYmEoJHtyfSwgJHtnfSwgJHtifSwgJHthbHBoYX0pYDtcbn07XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHRvX3JnYiggY29sb3VyX3JhbmdlICkge1xuXHR2YXIgYXJyID0gW10sXG5cdGksXG5cdG4gPSBjb2xvdXJfcmFuZ2UubGVuZ3RoO1xuXG5cdGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHtcblx0XHRhcnIucHVzaCggaGV4VG9SZ2IoIGNvbG91cl9yYW5nZVtpXSkgKTtcblx0fVxuICByZXR1cm4gYXJyO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgJ3ZlY3Rvcicgb2YgaGV4IGNvbG91cnMgKHdpdGggYWxwaGEpIGludG8gYW4gYXJyYXlcbiAqL1xuZnVuY3Rpb24gdG9fcmdiYSggY29sb3VyX3JhbmdlICkge1xuXHR2YXIgYXJyID0gW10sXG5cdGksXG5cdG4gPSBjb2xvdXJfcmFuZ2UubGVuZ3RoO1xuXG5cdGZvciAoaSA9IDA7IGkgPCBuOyBpKyspIHtcblx0XHRhcnIucHVzaCggaGV4VG9SR0JBKCBjb2xvdXJfcmFuZ2VbaV0pICk7XG5cdH1cbiAgcmV0dXJuIGFycjtcbn1cblxuZnVuY3Rpb24gY2hhbmdlX2xvY2F0aW9uKCBtYXBfaWQsIGxvY2F0aW9uLCBkdXJhdGlvbiwgdHJhbnNpdGlvbiwgem9vbSApIHtcblxuXHR3aW5kb3dbbWFwX2lkICsgJ21hcCddLnNldFByb3BzKHtcbiAgICB2aWV3U3RhdGU6IHtcbiAgICAgIGxvbmdpdHVkZTogbG9jYXRpb25bMF0sXG4gICAgICBsYXRpdHVkZTogbG9jYXRpb25bMV0sXG4gICAgICB6b29tOiB6b29tLFxuICAgICAgcGl0Y2g6IDAsXG4gICAgICBiZWFyaW5nOiAwLFxuICAgICAgdHJhbnNpdGlvbkludGVycG9sYXRvcjogdHJhbnNpdGlvbiA9PT0gXCJmbHlcIiA/IG5ldyBkZWNrLkZseVRvSW50ZXJwb2xhdG9yKCkgOiBuZXcgZGVjay5MaW5lYXJJbnRlcnBvbGF0b3IoKSxcbiAgICAgIHRyYW5zaXRpb25EdXJhdGlvbjogZHVyYXRpb25cbiAgICB9LFxuICB9KTtcbn1cblxuLy8gZm9sbG93aW5nOiBodHRwczovL2NvZGVwZW4uaW8vdmlzLWdsL3Blbi9wTExRcE5cbi8vIGFuZDogaHR0cHM6Ly9iZXRhLm9ic2VydmFibGVocS5jb20vQHBlc3NpbWlzdHJlc3MvZGVjay1nbC1nZW9qc29ubGF5ZXItZXhhbXBsZVxuZnVuY3Rpb24gdXBkYXRlVG9vbHRpcCh7eCwgeSwgb2JqZWN0fSkge1xuICBjb25zdCB0b29sdGlwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2x0aXAnKTtcbiAgaWYgKG9iamVjdCkge1xuICBcdGlmKG9iamVjdC50b29sdGlwID09PSB1bmRlZmluZWQpIHtcbiAgXHRcdHJldHVybjtcbiAgXHR9XG4gICAgdG9vbHRpcC5zdHlsZS50b3AgPSBgJHt5fXB4YDtcbiAgICB0b29sdGlwLnN0eWxlLmxlZnQgPSBgJHt4fXB4YDtcbiAgICB0b29sdGlwLmlubmVySFRNTCA9IGA8ZGl2PiR7b2JqZWN0LnRvb2x0aXB9PC9kaXY+YDtcbiAgfSBlbHNlIHtcbiAgICB0b29sdGlwLmlubmVySFRNTCA9ICcnO1xuICB9XG59XG5cbmZ1bmN0aW9uIGxheWVyX2NsaWNrKCBtYXBfaWQsIGxheWVyLCBpbmZvICkge1xuXG4gIGNvbnNvbGUubG9nKFwibGF5ZXIgY2xpY2tcIik7XG4gIGNvbnNvbGUubG9nKG1hcF9pZCArIFwiX1wiICsgbGF5ZXIgKyBcIl9jbGlja1wiKTtcblxuICBpZiAoICFIVE1MV2lkZ2V0cy5zaGlueU1vZGUgKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGV2ZW50SW5mbyA9IHtcbiAgXHRpbmRleDogaW5mby5pbmRleCxcbiAgXHRjb2xvcjogaW5mby5jb2xvcixcbiAgXHRvYmplY3Q6IGluZm8ub2JqZWN0LFxuICBcdGxheWVySWQ6IGluZm8ubGF5ZXJfaWQsXG4gIFx0bGF0OiBpbmZvLmxuZ0xhdFsxXSxcbiAgXHRsb246IGluZm8ubG5nTGF0WzBdXG4gIH07XG5cbiAgZXZlbnRJbmZvID0gSlNPTi5zdHJpbmdpZnkoIGV2ZW50SW5mbyApO1xuICBTaGlueS5vbklucHV0Q2hhbmdlKG1hcF9pZCArIFwiX1wiICsgbGF5ZXIgKyBcIl9jbGlja1wiLCBldmVudEluZm8pO1xufVxuXG5mdW5jdGlvbiBkZWNvZGVfcG9pbnRzKCBwb2x5bGluZSApIHtcblx0dmFyIGNvb3JkaW5hdGVzID0gZGVjb2RlX3BvbHlsaW5lKCBwb2x5bGluZSApIDtcblx0cmV0dXJuIGNvb3JkaW5hdGVzWzBdO1xufVxuXG5mdW5jdGlvbiBkZWNvZGVfcG9seWxpbmUoc3RyLCBwcmVjaXNpb24pIHtcbiAgdmFyIGluZGV4ID0gMCxcbiAgICAgIGxhdCA9IDAsXG4gICAgICBsbmcgPSAwLFxuICAgICAgY29vcmRpbmF0ZXMgPSBbXSxcbiAgICAgIHNoaWZ0ID0gMCxcbiAgICAgIHJlc3VsdCA9IDAsXG4gICAgICBieXRlID0gbnVsbCxcbiAgICAgIGxhdGl0dWRlX2NoYW5nZSxcbiAgICAgIGxvbmdpdHVkZV9jaGFuZ2UsXG4gICAgICBmYWN0b3IgPSBNYXRoLnBvdygxMCwgcHJlY2lzaW9uIHx8IDUpO1xuXG4gIC8vIENvb3JkaW5hdGVzIGhhdmUgdmFyaWFibGUgbGVuZ3RoIHdoZW4gZW5jb2RlZCwgc28ganVzdCBrZWVwXG4gIC8vIHRyYWNrIG9mIHdoZXRoZXIgd2UndmUgaGl0IHRoZSBlbmQgb2YgdGhlIHN0cmluZy4gSW4gZWFjaFxuICAvLyBsb29wIGl0ZXJhdGlvbiwgYSBzaW5nbGUgY29vcmRpbmF0ZSBpcyBkZWNvZGVkLlxuICB3aGlsZSAoaW5kZXggPCBzdHIubGVuZ3RoKSB7XG5cbiAgICAvLyBSZXNldCBzaGlmdCwgcmVzdWx0LCBhbmQgYnl0ZVxuICAgIGJ5dGUgPSBudWxsO1xuICAgIHNoaWZ0ID0gMDtcbiAgICByZXN1bHQgPSAwO1xuXG4gICAgZG8ge1xuICAgICAgYnl0ZSA9IHN0ci5jaGFyQ29kZUF0KGluZGV4KyspIC0gNjM7XG4gICAgICByZXN1bHQgfD0gKGJ5dGUgJiAweDFmKSA8PCBzaGlmdDtcbiAgICAgIHNoaWZ0ICs9IDU7XG4gICAgfSB3aGlsZSAoYnl0ZSA+PSAweDIwKTtcblxuICAgIGxhdGl0dWRlX2NoYW5nZSA9ICgocmVzdWx0ICYgMSkgPyB+KHJlc3VsdCA+PiAxKSA6IChyZXN1bHQgPj4gMSkpO1xuXG4gICAgc2hpZnQgPSByZXN1bHQgPSAwO1xuXG4gICAgZG8ge1xuICAgICAgYnl0ZSA9IHN0ci5jaGFyQ29kZUF0KGluZGV4KyspIC0gNjM7XG4gICAgICByZXN1bHQgfD0gKGJ5dGUgJiAweDFmKSA8PCBzaGlmdDtcbiAgICAgIHNoaWZ0ICs9IDU7XG4gICAgfSB3aGlsZSAoYnl0ZSA+PSAweDIwKTtcblxuICAgIGxvbmdpdHVkZV9jaGFuZ2UgPSAoKHJlc3VsdCAmIDEpID8gfihyZXN1bHQgPj4gMSkgOiAocmVzdWx0ID4+IDEpKTtcblxuICAgIGxhdCArPSBsYXRpdHVkZV9jaGFuZ2U7XG4gICAgbG5nICs9IGxvbmdpdHVkZV9jaGFuZ2U7XG5cbiAgICBjb29yZGluYXRlcy5wdXNoKFtsbmcgLyBmYWN0b3IsIGxhdCAvIGZhY3Rvcl0pO1xuICB9XG4gIHJldHVybiBjb29yZGluYXRlcztcbn1cbiIsImltcG9ydCBIVE1MV2lkZ2V0cyBmcm9tICcuL2dsb2JhbC9odG1sd2lkZ2V0cyc7XG5pbXBvcnQgeyBpbml0aWFsaXNlX21hcCB9IGZyb20gJy4vbW9kdWxlcy91dGlsaXRpZXMuanMnO1xuXG4vLyByZWZlcmVuY2Vcbi8vIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9SUNZTE9adUZNejhcblxuLy8gZXZlbiBpZiBpICdpbXBvcnQnIGV2ZXJ5dGhpbmcsIGlmIEkgZG5vJ3QgdXNlIHRoZSBmdW5jdGlvbiwgaXQgZG9lc24ndCBnZXQgaW1wb3J0ZWRcbi8vIGJlY2F1c2Ugb2Ygcm9sbHVwJ3MgJ3RyZWUgc2hha2luZydcblxuLy8gZGVwZW5kZW5jaWVzXG4vLy9ucG0gaW5zdGFsbCAtLXNhdmUtZGV2IHJvbGx1cC1wbHVnaW4tbm9kZS1yZXNvbHZlIHJvbGx1cC1wbHVnaW4tY29tbW9uanNcbi8vIG5vZGUtcmVzb2x2ZSwgZm9yIHJlc29sdmluZyBub2RlIG1vZHVsZXNcbi8vIGNvbW1vbmpzLCBmb3IgdXNpbmcgY29tbW9uIEpTIGFzIG5vZGUgbW9kdWxlc1xuXG5cbi8vIHJvbGx1cCBjb21tYW5kXG4vLyAuL25vZGVfbW9kdWxlcy8uYmluL3JvbGx1cCAtY1xuXG4vLyBiYWJlbCByY1xuLy8gbnBtIGluc3RhbGwgLS1zYXZlLWRldiBiYWJlbC1wcmVzZXQtZXMyMDE1LXJvbGx1cFxuXG5IVE1MV2lkZ2V0cy53aWRnZXQoe1xuXG4gIG5hbWU6ICdtYXBkZWNrJyxcbiAgdHlwZTogJ291dHB1dCcsXG5cbiAgZmFjdG9yeTogZnVuY3Rpb24oZWwsIHdpZHRoLCBoZWlnaHQpIHtcblxuICAgIC8vIFRPRE86IGRlZmluZSBzaGFyZWQgdmFyaWFibGVzIGZvciB0aGlzIGluc3RhbmNlXG4gICAgcmV0dXJuIHtcblxuICAgICAgcmVuZGVyVmFsdWU6IGZ1bmN0aW9uKHgpIHtcblxuICAgICAgICAvLyBUT0RPKGRvbid0IHVzZSB3aW5kb3cucGFyYW1zLCBvciwgY2hlY2sgaWYgdGhleSdyZSBhbHJlYWR5IGRlZmluZWQpXG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVuZGVyVmFsdWVcIik7XG4gICAgICBcdHdpbmRvdy5wYXJhbXMgPSBbXTtcbiAgICAgIFx0d2luZG93LnBhcmFtcy5wdXNoKHsgJ21hcF9pZCcgOiBlbC5pZCB9KTtcblxuICAgICAgXHR3aW5kb3dbZWwuaWQgKyAnbGF5ZXJzJ10gPSBbXTsgLy8ga2VlcCB0cmFjayBvZiBsYXllcnMgZm9yIG92ZXJsYXlpbmcgbXVsdGlwbGVcbiAgICAgIFx0Ly8gbmVlZHMgdG8gYmUgYW4gYXJyYXkgYmVjYXVzZSAucHJvcHMgdGFrZXMgYW4gYXJyYXkgb2YgbGF5ZXJzXG5cbiAgICAgICAgdmFyIG1hcERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsLmlkKTtcbiAgICAgICAgbWFwRGl2LmNsYXNzTmFtZSA9ICdtYXBkZWNrbWFwJztcblxuICAgICAgICB2YXIgdG9vbHRpcGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0b29sdGlwZGl2LmlkID0gJ3Rvb2x0aXAnO1xuICAgICAgICBtYXBEaXYuYXBwZW5kQ2hpbGQodG9vbHRpcGRpdik7XG5cbiAgICAgICAgLy8gSU5JVElBTCBWSUVXXG4gICAgICAgIHdpbmRvd1tlbC5pZCArICdJTklUSUFMX1ZJRVdfU1RBVEUnXSA9IHtcbiAgICAgICAgXHRsb25naXR1ZGU6IHgubG9jYXRpb25bMF0sXG4gICAgICAgIFx0bGF0aXR1ZGU6IHgubG9jYXRpb25bMV0sXG4gICAgICAgIFx0em9vbTogeC56b29tLFxuICAgICAgICBcdHBpdGNoOiB4LnBpdGNoXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3RcdGRlY2tnbCA9IG5ldyBEZWNrKHtcbiAgICAgICAgICBcdG1hcGJveEFwaUFjY2Vzc1Rva2VuOiB4LmFjY2Vzc190b2tlbixcblx0XHRcdCAgICAgIGNvbnRhaW5lcjogZWwuaWQsXG5cdFx0XHQgICAgICBtYXBTdHlsZTogeC5zdHlsZSxcblx0XHRcdCAgICAgIGluaXRpYWxWaWV3U3RhdGU6IHdpbmRvd1tlbC5pZCArICdJTklUSUFMX1ZJRVdfU1RBVEUnXSxcblx0XHRcdCAgICAgIGxheWVyczogW10sXG5cdFx0XHQgICAgICAvL29uTGF5ZXJIb3Zlcjogc2V0VG9vbHRpcFxuXHRcdFx0ICB9KTtcblxuXHRcdFx0ICBjb25zb2xlLmxvZyggZGVja2dsICk7XG5cblx0XHRcdCAgICB3aW5kb3dbZWwuaWQgKyAnbWFwJ10gPSBkZWNrZ2w7XG5cdFx0XHQgICAgaW5pdGlhbGlzZV9tYXAoZWwsIHgpO1xuICAgICAgfSxcblxuICAgICAgcmVzaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG5cbiAgICAgICAgLy8gVE9ETzogY29kZSB0byByZS1yZW5kZXIgdGhlIHdpZGdldCB3aXRoIGEgbmV3IHNpemVcbiAgICAgIH1cblxuICAgIH07XG4gIH1cbn0pO1xuXG5pZiAoSFRNTFdpZGdldHMuc2hpbnlNb2RlKSB7XG5cbiAgU2hpbnkuYWRkQ3VzdG9tTWVzc2FnZUhhbmRsZXIoXCJtYXBkZWNrbWFwLWNhbGxzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICB2YXIgaWQgPSBkYXRhLmlkLCAgIC8vIHRoZSBkaXYgaWQgb2YgdGhlIG1hcFxuICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCksXG4gICAgICBtYXAgPSBlbCxcbiAgICAgIGNhbGwgPSBbXSxcbiAgICAgIGkgPSAwO1xuXG4gICAgaWYgKCFtYXApIHtcbiAgICAgIC8vY29uc29sZS5sb2coXCJDb3VsZG4ndCBmaW5kIG1hcCB3aXRoIGlkIFwiICsgaWQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhLmNhbGxzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgIGNhbGwgPSBkYXRhLmNhbGxzW2ldO1xuXG4gICAgICAvL3B1c2ggdGhlIG1hcElkIGludG8gdGhlIGNhbGwuYXJnc1xuICAgICAgY2FsbC5hcmdzLnVuc2hpZnQoaWQpO1xuXG4gICAgICBpZiAoY2FsbC5kZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgU2hpbnkucmVuZGVyRGVwZW5kZW5jaWVzKGNhbGwuZGVwZW5kZW5jaWVzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHdpbmRvd1tjYWxsLm1ldGhvZF0pIHtcbiAgICAgICAgd2luZG93W2NhbGwubWV0aG9kXS5hcHBseSh3aW5kb3dbaWQgKyAnbWFwJ10sIGNhbGwuYXJncyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwiVW5rbm93biBmdW5jdGlvbiBcIiArIGNhbGwubWV0aG9kKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufVxuXG5cblxuXG4iXSwibmFtZXMiOlsid2luZG93IiwiSFRNTFdpZGdldHMiLCJpbml0aWFsaXNlX21hcCIsImVsIiwieCIsImNhbGxzIiwidW5kZWZpbmVkIiwiY29uc29sZSIsImxvZyIsImxheWVyQ2FsbHMiLCJsZW5ndGgiLCJhcmdzIiwidW5zaGlmdCIsImlkIiwiZnVuY3Rpb25zIiwiYXBwbHkiLCJ3aWRnZXQiLCJuYW1lIiwidHlwZSIsImZhY3RvcnkiLCJ3aWR0aCIsImhlaWdodCIsInJlbmRlclZhbHVlIiwicGFyYW1zIiwicHVzaCIsIm1hcERpdiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjbGFzc05hbWUiLCJ0b29sdGlwZGl2IiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwibG9uZ2l0dWRlIiwibG9jYXRpb24iLCJsYXRpdHVkZSIsInpvb20iLCJwaXRjaCIsImRlY2tnbCIsIkRlY2siLCJtYXBib3hBcGlBY2Nlc3NUb2tlbiIsImFjY2Vzc190b2tlbiIsImNvbnRhaW5lciIsIm1hcFN0eWxlIiwic3R5bGUiLCJpbml0aWFsVmlld1N0YXRlIiwibGF5ZXJzIiwicmVzaXplIiwic2hpbnlNb2RlIiwiU2hpbnkiLCJhZGRDdXN0b21NZXNzYWdlSGFuZGxlciIsImRhdGEiLCJtYXAiLCJjYWxsIiwiaSIsImRlcGVuZGVuY2llcyIsInJlbmRlckRlcGVuZGVuY2llcyIsIm1ldGhvZCJdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsc0JBQWVBLE9BQU9DLFdBQXRCOztFQ0NPLFNBQVNDLGNBQVQs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
