(function () {
  'use strict';

  var HTMLWidgets$1 = window.HTMLWidgets;

  function initialise_map(el, x) {

    // call initial layers
    var layerCalls;

    if (x.calls !== undefined) {

      console.log(x);

      for (layerCalls = 0; layerCalls < x.calls.length; layerCalls++) {

        //push the map_id into the call.args
        x.calls[layerCalls].args.unshift(el.id);

        if (window[x.calls[layerCalls].functions]) {

          window[x.calls[layerCalls].functions].apply(window[el.id + 'map'], x.calls[layerCalls].args);
        }
      }
    }
  }

  // reference
  // https://www.youtube.com/watch?v=ICYLOZuFMz8

  // even if i 'import' everything, if I dno't use the function, it doesn't get imported
  // because of rollup's 'tree shaking'

  // dependencies
  ///npm install --save-dev rollup-plugin-node-resolve rollup-plugin-commonjs
  // node-resolve, for resolving node modules
  // commonjs, for using common JS as node modules


  // rollup command
  // ./node_modules/.bin/rollup -c

  // babel rc
  // npm install --save-dev babel-preset-es2015-rollup

  HTMLWidgets$1.widget({

    name: 'mapdeck',
    type: 'output',

    factory: function factory(el, width, height) {

      // TODO: define shared variables for this instance
      return {

        renderValue: function renderValue(x) {

          // TODO(don't use window.params, or, check if they're already defined)
          console.log("renderValue");
          window.params = [];
          window.params.push({ 'map_id': el.id });

          window[el.id + 'layers'] = []; // keep track of layers for overlaying multiple
          // needs to be an array because .props takes an array of layers

          var mapDiv = document.getElementById(el.id);
          mapDiv.className = 'mapdeckmap';

          var tooltipdiv = document.createElement('div');
          tooltipdiv.id = 'tooltip';
          mapDiv.appendChild(tooltipdiv);

          // INITIAL VIEW
          window[el.id + 'INITIAL_VIEW_STATE'] = {
            longitude: x.location[0],
            latitude: x.location[1],
            zoom: x.zoom,
            pitch: x.pitch
          };

          var deckgl = new Deck({
            mapboxApiAccessToken: x.access_token,
            container: el.id,
            mapStyle: x.style,
            initialViewState: window[el.id + 'INITIAL_VIEW_STATE'],
            layers: []
            //onLayerHover: setTooltip
          });

          console.log("deckgl");
          console.log(deckgl);
          console.log(x);

          window[el.id + 'map'] = deckgl;
          initialise_map(el, x);
        },

        resize: function resize(width, height) {

          // TODO: code to re-render the widget with a new size
        }

      };
    }
  });

  if (HTMLWidgets$1.shinyMode) {

    Shiny.addCustomMessageHandler("mapdeckmap-calls", function (data) {

      var id = data.id,
          // the div id of the map
      el = document.getElementById(id),
          map = el,
          call = [],
          i = 0;

      if (!map) {
        //console.log("Couldn't find map with id " + id);
        return;
      }

      for (i = 0; i < data.calls.length; i++) {

        call = data.calls[i];

        //push the mapId into the call.args
        call.args.unshift(id);

        if (call.dependencies) {
          Shiny.renderDependencies(call.dependencies);
        }

        if (window[call.method]) {
          window[call.method].apply(window[id + 'map'], call.args);
        }
      }
    });
  }

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwZGVjay5qcyIsInNvdXJjZXMiOlsiLi4vLi4vamF2YXNjcmlwdC9nbG9iYWwvaHRtbHdpZGdldHMuanMiLCIuLi8uLi9qYXZhc2NyaXB0L21vZHVsZXMvdXRpbGl0aWVzLmpzIiwiLi4vLi4vamF2YXNjcmlwdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB3aW5kb3cuSFRNTFdpZGdldHM7XG4iLCJcbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXNlX21hcChlbCwgeCkge1xuXG5cdC8vIGNhbGwgaW5pdGlhbCBsYXllcnNcblx0dmFyIGxheWVyQ2FsbHM7XG5cbiAgaWYgKHguY2FsbHMgIT09IHVuZGVmaW5lZCkge1xuXG4gIFx0Y29uc29sZS5sb2coIHggKTtcblxuICAgIGZvciAobGF5ZXJDYWxscyA9IDA7IGxheWVyQ2FsbHMgPCB4LmNhbGxzLmxlbmd0aDsgbGF5ZXJDYWxscysrKSB7XG5cbiAgICAgIC8vcHVzaCB0aGUgbWFwX2lkIGludG8gdGhlIGNhbGwuYXJnc1xuICAgICAgeC5jYWxsc1tsYXllckNhbGxzXS5hcmdzLnVuc2hpZnQoZWwuaWQpO1xuXG4gICAgICBpZiAod2luZG93W3guY2FsbHNbbGF5ZXJDYWxsc10uZnVuY3Rpb25zXSkge1xuXG4gICAgICAgIHdpbmRvd1t4LmNhbGxzW2xheWVyQ2FsbHNdLmZ1bmN0aW9uc10uYXBwbHkod2luZG93W2VsLmlkICsgJ21hcCddLCB4LmNhbGxzW2xheWVyQ2FsbHNdLmFyZ3MpO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwiVW5rbm93biBmdW5jdGlvbiBcIiArIHguY2FsbHNbbGF5ZXJDYWxsc10pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kT2JqZWN0RWxlbWVudEJ5S2V5KGFycmF5LCBrZXksIHZhbHVlLCBsYXllcl9kYXRhICkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGFycmF5W2ldW2tleV0gPT09IHZhbHVlKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC0xO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVfbGF5ZXIoIG1hcF9pZCwgbGF5ZXJfaWQsIGxheWVyICkge1xuICB2YXIgZWxlbSA9IGZpbmRPYmplY3RFbGVtZW50QnlLZXkoIHdpbmRvd1ttYXBfaWQgKyAnbWFwJ10ucHJvcHMubGF5ZXJzLCAnaWQnLCBsYXllcl9pZCk7XG4gIGlmICggZWxlbSAhPSAtMSApIHtcbiAgXHR3aW5kb3dbIG1hcF9pZCArICdsYXllcnMnXVtlbGVtXSA9IGxheWVyO1xuICB9IGVsc2Uge1xuICBcdHdpbmRvd1ttYXBfaWQgKyAnbGF5ZXJzJ10ucHVzaCggbGF5ZXIgKTtcbiAgfVxuICB3aW5kb3dbbWFwX2lkICsgJ21hcCddLnNldFByb3BzKHsgbGF5ZXJzOiBbLi4ud2luZG93W21hcF9pZCArICdsYXllcnMnXSBdIH0pO1xufVxuXG5cbi8qKlxuICogaGV4IHRvIHJnYlxuICpcbiAqIENvbnZlcnRzIGhleCBjb2xvdXJzIHRvIHJnYlxuICovXG5jb25zdCBoZXhUb1JnYiA9IGhleCA9PlxuICBoZXgucmVwbGFjZSgvXiM/KFthLWZcXGRdKShbYS1mXFxkXSkoW2EtZlxcZF0pJC9pXG4gICAgICAgICAgICAgLChtLCByLCBnLCBiKSA9PiAnIycgKyByICsgciArIGcgKyBnICsgYiArIGIpXG4gICAgLnN1YnN0cmluZygxKS5tYXRjaCgvLnsyfS9nKVxuICAgIC5tYXAoeCA9PiBwYXJzZUludCh4LCAxNikpO1xuXG5jb25zdCBoZXhUb1JHQkEgPSAoaGV4LCBhbHBoYSA9IDI1NSkgPT4ge1xuICAgIGxldCBwYXJzZVN0cmluZyA9IGhleDtcbiAgICBpZiAoaGV4LnN0YXJ0c1dpdGgoJyMnKSkge3BhcnNlU3RyaW5nID0gaGV4LnNsaWNlKDEsIDcpO31cbiAgICBpZiAocGFyc2VTdHJpbmcubGVuZ3RoICE9PSA2KSB7cmV0dXJuIG51bGw7fVxuICAgIGNvbnN0IHIgPSBwYXJzZUludChwYXJzZVN0cmluZy5zbGljZSgwLCAyKSwgMTYpO1xuICAgIGNvbnN0IGcgPSBwYXJzZUludChwYXJzZVN0cmluZy5zbGljZSgyLCA0KSwgMTYpO1xuICAgIGNvbnN0IGIgPSBwYXJzZUludChwYXJzZVN0cmluZy5zbGljZSg0LCA2KSwgMTYpO1xuICAgIGlmIChpc05hTihyKSB8fCBpc05hTihnKSB8fCBpc05hTihiKSkge3JldHVybiBudWxsO31cbiAgICByZXR1cm4gW3IsIGcsIGIsIGFscGhhXTtcbiAgICAvL3JldHVybiBgcmdiYSgke3J9LCAke2d9LCAke2J9LCAke2FscGhhfSlgO1xufTtcblxuXG5leHBvcnQgZnVuY3Rpb24gdG9fcmdiKCBjb2xvdXJfcmFuZ2UgKSB7XG5cdHZhciBhcnIgPSBbXSxcblx0aSxcblx0biA9IGNvbG91cl9yYW5nZS5sZW5ndGg7XG5cblx0Zm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuXHRcdGFyci5wdXNoKCBoZXhUb1JnYiggY29sb3VyX3JhbmdlW2ldKSApO1xuXHR9XG4gIHJldHVybiBhcnI7XG59XG5cbi8qKlxuICogQ29udmVydHMgYSAndmVjdG9yJyBvZiBoZXggY29sb3VycyAod2l0aCBhbHBoYSkgaW50byBhbiBhcnJheVxuICovXG5mdW5jdGlvbiB0b19yZ2JhKCBjb2xvdXJfcmFuZ2UgKSB7XG5cdHZhciBhcnIgPSBbXSxcblx0aSxcblx0biA9IGNvbG91cl9yYW5nZS5sZW5ndGg7XG5cblx0Zm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuXHRcdGFyci5wdXNoKCBoZXhUb1JHQkEoIGNvbG91cl9yYW5nZVtpXSkgKTtcblx0fVxuICByZXR1cm4gYXJyO1xufVxuXG5mdW5jdGlvbiBjaGFuZ2VfbG9jYXRpb24oIG1hcF9pZCwgbG9jYXRpb24sIGR1cmF0aW9uLCB0cmFuc2l0aW9uLCB6b29tICkge1xuXG5cdHdpbmRvd1ttYXBfaWQgKyAnbWFwJ10uc2V0UHJvcHMoe1xuICAgIHZpZXdTdGF0ZToge1xuICAgICAgbG9uZ2l0dWRlOiBsb2NhdGlvblswXSxcbiAgICAgIGxhdGl0dWRlOiBsb2NhdGlvblsxXSxcbiAgICAgIHpvb206IHpvb20sXG4gICAgICBwaXRjaDogMCxcbiAgICAgIGJlYXJpbmc6IDAsXG4gICAgICB0cmFuc2l0aW9uSW50ZXJwb2xhdG9yOiB0cmFuc2l0aW9uID09PSBcImZseVwiID8gbmV3IGRlY2suRmx5VG9JbnRlcnBvbGF0b3IoKSA6IG5ldyBkZWNrLkxpbmVhckludGVycG9sYXRvcigpLFxuICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiBkdXJhdGlvblxuICAgIH0sXG4gIH0pO1xufVxuXG4vLyBmb2xsb3dpbmc6IGh0dHBzOi8vY29kZXBlbi5pby92aXMtZ2wvcGVuL3BMTFFwTlxuLy8gYW5kOiBodHRwczovL2JldGEub2JzZXJ2YWJsZWhxLmNvbS9AcGVzc2ltaXN0cmVzcy9kZWNrLWdsLWdlb2pzb25sYXllci1leGFtcGxlXG5mdW5jdGlvbiB1cGRhdGVUb29sdGlwKHt4LCB5LCBvYmplY3R9KSB7XG4gIGNvbnN0IHRvb2x0aXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbHRpcCcpO1xuICBpZiAob2JqZWN0KSB7XG4gIFx0aWYob2JqZWN0LnRvb2x0aXAgPT09IHVuZGVmaW5lZCkge1xuICBcdFx0cmV0dXJuO1xuICBcdH1cbiAgICB0b29sdGlwLnN0eWxlLnRvcCA9IGAke3l9cHhgO1xuICAgIHRvb2x0aXAuc3R5bGUubGVmdCA9IGAke3h9cHhgO1xuICAgIHRvb2x0aXAuaW5uZXJIVE1MID0gYDxkaXY+JHtvYmplY3QudG9vbHRpcH08L2Rpdj5gO1xuICB9IGVsc2Uge1xuICAgIHRvb2x0aXAuaW5uZXJIVE1MID0gJyc7XG4gIH1cbn1cblxuZnVuY3Rpb24gbGF5ZXJfY2xpY2soIG1hcF9pZCwgbGF5ZXIsIGluZm8gKSB7XG5cbiAgY29uc29sZS5sb2coXCJsYXllciBjbGlja1wiKTtcbiAgY29uc29sZS5sb2cobWFwX2lkICsgXCJfXCIgKyBsYXllciArIFwiX2NsaWNrXCIpO1xuXG4gIGlmICggIUhUTUxXaWRnZXRzLnNoaW55TW9kZSApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgZXZlbnRJbmZvID0ge1xuICBcdGluZGV4OiBpbmZvLmluZGV4LFxuICBcdGNvbG9yOiBpbmZvLmNvbG9yLFxuICBcdG9iamVjdDogaW5mby5vYmplY3QsXG4gIFx0bGF5ZXJJZDogaW5mby5sYXllcl9pZCxcbiAgXHRsYXQ6IGluZm8ubG5nTGF0WzFdLFxuICBcdGxvbjogaW5mby5sbmdMYXRbMF1cbiAgfTtcblxuICBldmVudEluZm8gPSBKU09OLnN0cmluZ2lmeSggZXZlbnRJbmZvICk7XG4gIFNoaW55Lm9uSW5wdXRDaGFuZ2UobWFwX2lkICsgXCJfXCIgKyBsYXllciArIFwiX2NsaWNrXCIsIGV2ZW50SW5mbyk7XG59XG5cbmZ1bmN0aW9uIGRlY29kZV9wb2ludHMoIHBvbHlsaW5lICkge1xuXHR2YXIgY29vcmRpbmF0ZXMgPSBkZWNvZGVfcG9seWxpbmUoIHBvbHlsaW5lICkgO1xuXHRyZXR1cm4gY29vcmRpbmF0ZXNbMF07XG59XG5cbmZ1bmN0aW9uIGRlY29kZV9wb2x5bGluZShzdHIsIHByZWNpc2lvbikge1xuICB2YXIgaW5kZXggPSAwLFxuICAgICAgbGF0ID0gMCxcbiAgICAgIGxuZyA9IDAsXG4gICAgICBjb29yZGluYXRlcyA9IFtdLFxuICAgICAgc2hpZnQgPSAwLFxuICAgICAgcmVzdWx0ID0gMCxcbiAgICAgIGJ5dGUgPSBudWxsLFxuICAgICAgbGF0aXR1ZGVfY2hhbmdlLFxuICAgICAgbG9uZ2l0dWRlX2NoYW5nZSxcbiAgICAgIGZhY3RvciA9IE1hdGgucG93KDEwLCBwcmVjaXNpb24gfHwgNSk7XG5cbiAgLy8gQ29vcmRpbmF0ZXMgaGF2ZSB2YXJpYWJsZSBsZW5ndGggd2hlbiBlbmNvZGVkLCBzbyBqdXN0IGtlZXBcbiAgLy8gdHJhY2sgb2Ygd2hldGhlciB3ZSd2ZSBoaXQgdGhlIGVuZCBvZiB0aGUgc3RyaW5nLiBJbiBlYWNoXG4gIC8vIGxvb3AgaXRlcmF0aW9uLCBhIHNpbmdsZSBjb29yZGluYXRlIGlzIGRlY29kZWQuXG4gIHdoaWxlIChpbmRleCA8IHN0ci5sZW5ndGgpIHtcblxuICAgIC8vIFJlc2V0IHNoaWZ0LCByZXN1bHQsIGFuZCBieXRlXG4gICAgYnl0ZSA9IG51bGw7XG4gICAgc2hpZnQgPSAwO1xuICAgIHJlc3VsdCA9IDA7XG5cbiAgICBkbyB7XG4gICAgICBieXRlID0gc3RyLmNoYXJDb2RlQXQoaW5kZXgrKykgLSA2MztcbiAgICAgIHJlc3VsdCB8PSAoYnl0ZSAmIDB4MWYpIDw8IHNoaWZ0O1xuICAgICAgc2hpZnQgKz0gNTtcbiAgICB9IHdoaWxlIChieXRlID49IDB4MjApO1xuXG4gICAgbGF0aXR1ZGVfY2hhbmdlID0gKChyZXN1bHQgJiAxKSA/IH4ocmVzdWx0ID4+IDEpIDogKHJlc3VsdCA+PiAxKSk7XG5cbiAgICBzaGlmdCA9IHJlc3VsdCA9IDA7XG5cbiAgICBkbyB7XG4gICAgICBieXRlID0gc3RyLmNoYXJDb2RlQXQoaW5kZXgrKykgLSA2MztcbiAgICAgIHJlc3VsdCB8PSAoYnl0ZSAmIDB4MWYpIDw8IHNoaWZ0O1xuICAgICAgc2hpZnQgKz0gNTtcbiAgICB9IHdoaWxlIChieXRlID49IDB4MjApO1xuXG4gICAgbG9uZ2l0dWRlX2NoYW5nZSA9ICgocmVzdWx0ICYgMSkgPyB+KHJlc3VsdCA+PiAxKSA6IChyZXN1bHQgPj4gMSkpO1xuXG4gICAgbGF0ICs9IGxhdGl0dWRlX2NoYW5nZTtcbiAgICBsbmcgKz0gbG9uZ2l0dWRlX2NoYW5nZTtcblxuICAgIGNvb3JkaW5hdGVzLnB1c2goW2xuZyAvIGZhY3RvciwgbGF0IC8gZmFjdG9yXSk7XG4gIH1cbiAgcmV0dXJuIGNvb3JkaW5hdGVzO1xufVxuIiwiaW1wb3J0IEhUTUxXaWRnZXRzIGZyb20gJy4vZ2xvYmFsL2h0bWx3aWRnZXRzJztcbmltcG9ydCB7IGluaXRpYWxpc2VfbWFwIH0gZnJvbSAnLi9tb2R1bGVzL3V0aWxpdGllcy5qcyc7XG5cbi8vIHJlZmVyZW5jZVxuLy8gaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1JQ1lMT1p1Rk16OFxuXG4vLyBldmVuIGlmIGkgJ2ltcG9ydCcgZXZlcnl0aGluZywgaWYgSSBkbm8ndCB1c2UgdGhlIGZ1bmN0aW9uLCBpdCBkb2Vzbid0IGdldCBpbXBvcnRlZFxuLy8gYmVjYXVzZSBvZiByb2xsdXAncyAndHJlZSBzaGFraW5nJ1xuXG4vLyBkZXBlbmRlbmNpZXNcbi8vL25wbSBpbnN0YWxsIC0tc2F2ZS1kZXYgcm9sbHVwLXBsdWdpbi1ub2RlLXJlc29sdmUgcm9sbHVwLXBsdWdpbi1jb21tb25qc1xuLy8gbm9kZS1yZXNvbHZlLCBmb3IgcmVzb2x2aW5nIG5vZGUgbW9kdWxlc1xuLy8gY29tbW9uanMsIGZvciB1c2luZyBjb21tb24gSlMgYXMgbm9kZSBtb2R1bGVzXG5cblxuLy8gcm9sbHVwIGNvbW1hbmRcbi8vIC4vbm9kZV9tb2R1bGVzLy5iaW4vcm9sbHVwIC1jXG5cbi8vIGJhYmVsIHJjXG4vLyBucG0gaW5zdGFsbCAtLXNhdmUtZGV2IGJhYmVsLXByZXNldC1lczIwMTUtcm9sbHVwXG5cbkhUTUxXaWRnZXRzLndpZGdldCh7XG5cbiAgbmFtZTogJ21hcGRlY2snLFxuICB0eXBlOiAnb3V0cHV0JyxcblxuICBmYWN0b3J5OiBmdW5jdGlvbihlbCwgd2lkdGgsIGhlaWdodCkge1xuXG4gICAgLy8gVE9ETzogZGVmaW5lIHNoYXJlZCB2YXJpYWJsZXMgZm9yIHRoaXMgaW5zdGFuY2VcbiAgICByZXR1cm4ge1xuXG4gICAgICByZW5kZXJWYWx1ZTogZnVuY3Rpb24oeCkge1xuXG4gICAgICAgIC8vIFRPRE8oZG9uJ3QgdXNlIHdpbmRvdy5wYXJhbXMsIG9yLCBjaGVjayBpZiB0aGV5J3JlIGFscmVhZHkgZGVmaW5lZClcbiAgICAgICAgY29uc29sZS5sb2coXCJyZW5kZXJWYWx1ZVwiKTtcbiAgICAgIFx0d2luZG93LnBhcmFtcyA9IFtdO1xuICAgICAgXHR3aW5kb3cucGFyYW1zLnB1c2goeyAnbWFwX2lkJyA6IGVsLmlkIH0pO1xuXG4gICAgICBcdHdpbmRvd1tlbC5pZCArICdsYXllcnMnXSA9IFtdOyAvLyBrZWVwIHRyYWNrIG9mIGxheWVycyBmb3Igb3ZlcmxheWluZyBtdWx0aXBsZVxuICAgICAgXHQvLyBuZWVkcyB0byBiZSBhbiBhcnJheSBiZWNhdXNlIC5wcm9wcyB0YWtlcyBhbiBhcnJheSBvZiBsYXllcnNcblxuICAgICAgICB2YXIgbWFwRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWwuaWQpO1xuICAgICAgICBtYXBEaXYuY2xhc3NOYW1lID0gJ21hcGRlY2ttYXAnO1xuXG4gICAgICAgIHZhciB0b29sdGlwZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRvb2x0aXBkaXYuaWQgPSAndG9vbHRpcCc7XG4gICAgICAgIG1hcERpdi5hcHBlbmRDaGlsZCh0b29sdGlwZGl2KTtcblxuICAgICAgICAvLyBJTklUSUFMIFZJRVdcbiAgICAgICAgd2luZG93W2VsLmlkICsgJ0lOSVRJQUxfVklFV19TVEFURSddID0ge1xuICAgICAgICBcdGxvbmdpdHVkZTogeC5sb2NhdGlvblswXSxcbiAgICAgICAgXHRsYXRpdHVkZTogeC5sb2NhdGlvblsxXSxcbiAgICAgICAgXHR6b29tOiB4Lnpvb20sXG4gICAgICAgIFx0cGl0Y2g6IHgucGl0Y2hcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdFx0ZGVja2dsID0gbmV3IERlY2soe1xuICAgICAgICAgIG1hcGJveEFwaUFjY2Vzc1Rva2VuOiB4LmFjY2Vzc190b2tlbixcblx0XHRcdCAgICBjb250YWluZXI6IGVsLmlkLFxuXHRcdFx0ICAgIG1hcFN0eWxlOiB4LnN0eWxlLFxuXHRcdFx0ICAgIGluaXRpYWxWaWV3U3RhdGU6IHdpbmRvd1tlbC5pZCArICdJTklUSUFMX1ZJRVdfU1RBVEUnXSxcblx0XHRcdCAgICBsYXllcnM6IFtdLFxuXHRcdFx0ICAgIC8vb25MYXllckhvdmVyOiBzZXRUb29sdGlwXG5cdFx0XHQgIH0pO1xuXG5cdFx0XHQgIGNvbnNvbGUubG9nKCBcImRlY2tnbFwiICk7XG5cdFx0XHQgIGNvbnNvbGUubG9nKCBkZWNrZ2wgKTtcblx0XHRcdCAgY29uc29sZS5sb2coIHggKTtcblxuXHRcdFx0ICB3aW5kb3dbZWwuaWQgKyAnbWFwJ10gPSBkZWNrZ2w7XG5cdFx0XHQgIGluaXRpYWxpc2VfbWFwKGVsLCB4KTtcbiAgICAgIH0sXG5cbiAgICAgIHJlc2l6ZTogZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuXG4gICAgICAgIC8vIFRPRE86IGNvZGUgdG8gcmUtcmVuZGVyIHRoZSB3aWRnZXQgd2l0aCBhIG5ldyBzaXplXG4gICAgICB9XG5cbiAgICB9O1xuICB9XG59KTtcblxuaWYgKEhUTUxXaWRnZXRzLnNoaW55TW9kZSkge1xuXG4gIFNoaW55LmFkZEN1c3RvbU1lc3NhZ2VIYW5kbGVyKFwibWFwZGVja21hcC1jYWxsc1wiLCBmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgdmFyIGlkID0gZGF0YS5pZCwgICAvLyB0aGUgZGl2IGlkIG9mIHRoZSBtYXBcbiAgICAgIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLFxuICAgICAgbWFwID0gZWwsXG4gICAgICBjYWxsID0gW10sXG4gICAgICBpID0gMDtcblxuICAgIGlmICghbWFwKSB7XG4gICAgICAvL2NvbnNvbGUubG9nKFwiQ291bGRuJ3QgZmluZCBtYXAgd2l0aCBpZCBcIiArIGlkKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YS5jYWxscy5sZW5ndGg7IGkrKykge1xuXG4gICAgICBjYWxsID0gZGF0YS5jYWxsc1tpXTtcblxuICAgICAgLy9wdXNoIHRoZSBtYXBJZCBpbnRvIHRoZSBjYWxsLmFyZ3NcbiAgICAgIGNhbGwuYXJncy51bnNoaWZ0KGlkKTtcblxuICAgICAgaWYgKGNhbGwuZGVwZW5kZW5jaWVzKSB7XG4gICAgICAgIFNoaW55LnJlbmRlckRlcGVuZGVuY2llcyhjYWxsLmRlcGVuZGVuY2llcyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh3aW5kb3dbY2FsbC5tZXRob2RdKSB7XG4gICAgICAgIHdpbmRvd1tjYWxsLm1ldGhvZF0uYXBwbHkod2luZG93W2lkICsgJ21hcCddLCBjYWxsLmFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIlVua25vd24gZnVuY3Rpb24gXCIgKyBjYWxsLm1ldGhvZCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuXG5cblxuIl0sIm5hbWVzIjpbIndpbmRvdyIsIkhUTUxXaWRnZXRzIiwiaW5pdGlhbGlzZV9tYXAiLCJlbCIsIngiLCJsYXllckNhbGxzIiwiY2FsbHMiLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwibG9nIiwibGVuZ3RoIiwiYXJncyIsInVuc2hpZnQiLCJpZCIsImZ1bmN0aW9ucyIsImFwcGx5Iiwid2lkZ2V0IiwibmFtZSIsInR5cGUiLCJmYWN0b3J5Iiwid2lkdGgiLCJoZWlnaHQiLCJyZW5kZXJWYWx1ZSIsInBhcmFtcyIsInB1c2giLCJtYXBEaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY2xhc3NOYW1lIiwidG9vbHRpcGRpdiIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsImxvbmdpdHVkZSIsImxvY2F0aW9uIiwibGF0aXR1ZGUiLCJ6b29tIiwicGl0Y2giLCJkZWNrZ2wiLCJEZWNrIiwibWFwYm94QXBpQWNjZXNzVG9rZW4iLCJhY2Nlc3NfdG9rZW4iLCJjb250YWluZXIiLCJtYXBTdHlsZSIsInN0eWxlIiwiaW5pdGlhbFZpZXdTdGF0ZSIsImxheWVycyIsInJlc2l6ZSIsInNoaW55TW9kZSIsIlNoaW55IiwiYWRkQ3VzdG9tTWVzc2FnZUhhbmRsZXIiLCJkYXRhIiwibWFwIiwiY2FsbCIsImkiLCJkZXBlbmRlbmNpZXMiLCJyZW5kZXJEZXBlbmRlbmNpZXMiLCJt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
