(function () {
  'use strict';

  var HTMLWidgets$1 = window.HTMLWidgets;

  function initialise_map(el, x) {

    // call initial layers
    if (x.calls !== undefined) {

      for (layerCalls = 0; layerCalls < x.calls.length; layerCalls++) {

        //push the map_id into the call.args
        x.calls[layerCalls].args.unshift(el.id);

        if (window[x.calls[layerCalls].functions]) {

          window[x.calls[layerCalls].functions].apply(window[el.id + 'map'], x.calls[layerCalls].args);
        }
      }
    }
  }

  // reference
  // https://www.youtube.com/watch?v=ICYLOZuFMz8

  // rollup command
  // ./node_modules/.bin/rollup -c

  // babel rc
  // npm install --save-dev babel-preset-es2015-rollup

  HTMLWidgets$1.widget({

    name: 'mapdeck',
    type: 'output',

    factory: function factory(el, width, height) {

      // TODO: define shared variables for this instance
      return {

        renderValue: function renderValue(x) {

          window.params = [];
          window.params.push({ 'map_id': el.id });

          window[el.id + 'layers'] = []; // keep track of layers for overlaying multiple
          // needs to be an array because .props takes an array of layers

          var mapDiv = document.getElementById(el.id);
          mapDiv.className = 'mapdeckmap';

          var tooltipdiv = document.createElement('div');
          tooltipdiv.id = 'tooltip';
          mapDiv.appendChild(tooltipdiv);

          // INITIAL VIEW
          window[el.id + 'INITIAL_VIEW_STATE'] = {
            longitude: x.location[0],
            latitude: x.location[1],
            zoom: x.zoom,
            pitch: x.pitch
          };

          var deckgl = new deck.DeckGL({
            mapboxApiAccessToken: x.access_token,
            container: el.id,
            mapStyle: x.style,
            initialViewState: window[el.id + 'INITIAL_VIEW_STATE'],
            layers: []
            //onLayerHover: setTooltip
          });

          window[el.id + 'map'] = deckgl;
          initialise_map(el, x);
        },

        resize: function resize(width, height) {

          // TODO: code to re-render the widget with a new size
        }

      };
    }
  });

  if (HTMLWidgets$1.shinyMode) {

    Shiny.addCustomMessageHandler("mapdeckmap-calls", function (data) {

      var id = data.id,
          // the div id of the map
      el = document.getElementById(id),
          map = el,
          call = [],
          i = 0;

      if (!map) {
        //console.log("Couldn't find map with id " + id);
        return;
      }

      for (i = 0; i < data.calls.length; i++) {

        call = data.calls[i];

        //push the mapId into the call.args
        call.args.unshift(id);

        if (call.dependencies) {
          Shiny.renderDependencies(call.dependencies);
        }

        if (window[call.method]) {
          window[call.method].apply(window[id + 'map'], call.args);
        }
      }
    });
  }

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwZGVjay5qcyIsInNvdXJjZXMiOlsiLi4vLi4vamF2YXNjcmlwdC9nbG9iYWwvaHRtbHdpZGdldHMuanMiLCIuLi8uLi9qYXZhc2NyaXB0L21vZHVsZXMvdXRpbGl0aWVzLmpzIiwiLi4vLi4vamF2YXNjcmlwdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB3aW5kb3cuSFRNTFdpZGdldHM7XG4iLCJcbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXNlX21hcChlbCwgeCkge1xuXG5cdC8vIGNhbGwgaW5pdGlhbCBsYXllcnNcbiAgaWYgKHguY2FsbHMgIT09IHVuZGVmaW5lZCkge1xuXG4gICAgZm9yIChsYXllckNhbGxzID0gMDsgbGF5ZXJDYWxscyA8IHguY2FsbHMubGVuZ3RoOyBsYXllckNhbGxzKyspIHtcblxuICAgICAgLy9wdXNoIHRoZSBtYXBfaWQgaW50byB0aGUgY2FsbC5hcmdzXG4gICAgICB4LmNhbGxzW2xheWVyQ2FsbHNdLmFyZ3MudW5zaGlmdChlbC5pZCk7XG5cbiAgICAgIGlmICh3aW5kb3dbeC5jYWxsc1tsYXllckNhbGxzXS5mdW5jdGlvbnNdKSB7XG5cbiAgICAgICAgd2luZG93W3guY2FsbHNbbGF5ZXJDYWxsc10uZnVuY3Rpb25zXS5hcHBseSh3aW5kb3dbZWwuaWQgKyAnbWFwJ10sIHguY2FsbHNbbGF5ZXJDYWxsc10uYXJncyk7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJVbmtub3duIGZ1bmN0aW9uIFwiICsgeC5jYWxsc1tsYXllckNhbGxzXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cblxuZnVuY3Rpb24gZmluZE9iamVjdEVsZW1lbnRCeUtleShhcnJheSwga2V5LCB2YWx1ZSwgbGF5ZXJfZGF0YSApIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChhcnJheVtpXVtrZXldID09PSB2YWx1ZSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG4gIHJldHVybiAtMTtcbn1cblxuXG5mdW5jdGlvbiB1cGRhdGVfbGF5ZXIoIG1hcF9pZCwgbGF5ZXJfaWQsIGxheWVyICkge1xuICB2YXIgZWxlbSA9IGZpbmRPYmplY3RFbGVtZW50QnlLZXkoIHdpbmRvd1ttYXBfaWQgKyAnbWFwJ10ucHJvcHMubGF5ZXJzLCAnaWQnLCBsYXllcl9pZCk7XG4gIGlmICggZWxlbSAhPSAtMSApIHtcbiAgXHR3aW5kb3dbIG1hcF9pZCArICdsYXllcnMnXVtlbGVtXSA9IGxheWVyO1xuICB9IGVsc2Uge1xuICBcdHdpbmRvd1ttYXBfaWQgKyAnbGF5ZXJzJ10ucHVzaCggbGF5ZXIgKTtcbiAgfVxuICB3aW5kb3dbbWFwX2lkICsgJ21hcCddLnNldFByb3BzKHsgbGF5ZXJzOiBbLi4ud2luZG93W21hcF9pZCArICdsYXllcnMnXSBdIH0pO1xufVxuXG5cbi8qKlxuICogaGV4IHRvIHJnYlxuICpcbiAqIENvbnZlcnRzIGhleCBjb2xvdXJzIHRvIHJnYlxuICovXG5jb25zdCBoZXhUb1JnYiA9IGhleCA9PlxuICBoZXgucmVwbGFjZSgvXiM/KFthLWZcXGRdKShbYS1mXFxkXSkoW2EtZlxcZF0pJC9pXG4gICAgICAgICAgICAgLChtLCByLCBnLCBiKSA9PiAnIycgKyByICsgciArIGcgKyBnICsgYiArIGIpXG4gICAgLnN1YnN0cmluZygxKS5tYXRjaCgvLnsyfS9nKVxuICAgIC5tYXAoeCA9PiBwYXJzZUludCh4LCAxNikpO1xuXG5jb25zdCBoZXhUb1JHQkEgPSAoaGV4LCBhbHBoYSA9IDI1NSkgPT4ge1xuICAgIGxldCBwYXJzZVN0cmluZyA9IGhleDtcbiAgICBpZiAoaGV4LnN0YXJ0c1dpdGgoJyMnKSkge3BhcnNlU3RyaW5nID0gaGV4LnNsaWNlKDEsIDcpO31cbiAgICBpZiAocGFyc2VTdHJpbmcubGVuZ3RoICE9PSA2KSB7cmV0dXJuIG51bGw7fVxuICAgIGNvbnN0IHIgPSBwYXJzZUludChwYXJzZVN0cmluZy5zbGljZSgwLCAyKSwgMTYpO1xuICAgIGNvbnN0IGcgPSBwYXJzZUludChwYXJzZVN0cmluZy5zbGljZSgyLCA0KSwgMTYpO1xuICAgIGNvbnN0IGIgPSBwYXJzZUludChwYXJzZVN0cmluZy5zbGljZSg0LCA2KSwgMTYpO1xuICAgIGlmIChpc05hTihyKSB8fCBpc05hTihnKSB8fCBpc05hTihiKSkge3JldHVybiBudWxsO31cbiAgICByZXR1cm4gW3IsIGcsIGIsIGFscGhhXTtcbiAgICAvL3JldHVybiBgcmdiYSgke3J9LCAke2d9LCAke2J9LCAke2FscGhhfSlgO1xufTtcblxuXG5leHBvcnQgZnVuY3Rpb24gdG9fcmdiKCBjb2xvdXJfcmFuZ2UgKSB7XG5cdHZhciBhcnIgPSBbXSxcblx0aSxcblx0biA9IGNvbG91cl9yYW5nZS5sZW5ndGg7XG5cblx0Zm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuXHRcdGFyci5wdXNoKCBoZXhUb1JnYiggY29sb3VyX3JhbmdlW2ldKSApO1xuXHR9XG4gIHJldHVybiBhcnI7XG59XG5cbi8qKlxuICogQ29udmVydHMgYSAndmVjdG9yJyBvZiBoZXggY29sb3VycyAod2l0aCBhbHBoYSkgaW50byBhbiBhcnJheVxuICovXG5mdW5jdGlvbiB0b19yZ2JhKCBjb2xvdXJfcmFuZ2UgKSB7XG5cdHZhciBhcnIgPSBbXSxcblx0aSxcblx0biA9IGNvbG91cl9yYW5nZS5sZW5ndGg7XG5cblx0Zm9yIChpID0gMDsgaSA8IG47IGkrKykge1xuXHRcdGFyci5wdXNoKCBoZXhUb1JHQkEoIGNvbG91cl9yYW5nZVtpXSkgKTtcblx0fVxuICByZXR1cm4gYXJyO1xufVxuXG5mdW5jdGlvbiBsYXllcl9jbGljayggbWFwX2lkLCBsYXllciwgaW5mbyApIHtcblxuICBjb25zb2xlLmxvZyhcImxheWVyIGNsaWNrXCIpO1xuICBjb25zb2xlLmxvZyhtYXBfaWQgKyBcIl9cIiArIGxheWVyICsgXCJfY2xpY2tcIik7XG5cbiAgaWYgKCAhSFRNTFdpZGdldHMuc2hpbnlNb2RlICkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBldmVudEluZm8gPSB7XG4gIFx0aW5kZXg6IGluZm8uaW5kZXgsXG4gIFx0Y29sb3I6IGluZm8uY29sb3IsXG4gIFx0b2JqZWN0OiBpbmZvLm9iamVjdCxcbiAgXHRsYXllcklkOiBpbmZvLmxheWVyX2lkLFxuICBcdGxhdDogaW5mby5sbmdMYXRbMV0sXG4gIFx0bG9uOiBpbmZvLmxuZ0xhdFswXVxuICB9O1xuXG4gIGV2ZW50SW5mbyA9IEpTT04uc3RyaW5naWZ5KCBldmVudEluZm8gKTtcbiAgU2hpbnkub25JbnB1dENoYW5nZShtYXBfaWQgKyBcIl9cIiArIGxheWVyICsgXCJfY2xpY2tcIiwgZXZlbnRJbmZvKTtcbn1cblxuZnVuY3Rpb24gZGVjb2RlX3BvaW50cyggcG9seWxpbmUgKSB7XG5cdHZhciBjb29yZGluYXRlcyA9IGRlY29kZV9wb2x5bGluZSggcG9seWxpbmUgKSA7XG5cdHJldHVybiBjb29yZGluYXRlc1swXTtcbn1cblxuZnVuY3Rpb24gZGVjb2RlX3BvbHlsaW5lKHN0ciwgcHJlY2lzaW9uKSB7XG4gIHZhciBpbmRleCA9IDAsXG4gICAgICBsYXQgPSAwLFxuICAgICAgbG5nID0gMCxcbiAgICAgIGNvb3JkaW5hdGVzID0gW10sXG4gICAgICBzaGlmdCA9IDAsXG4gICAgICByZXN1bHQgPSAwLFxuICAgICAgYnl0ZSA9IG51bGwsXG4gICAgICBsYXRpdHVkZV9jaGFuZ2UsXG4gICAgICBsb25naXR1ZGVfY2hhbmdlLFxuICAgICAgZmFjdG9yID0gTWF0aC5wb3coMTAsIHByZWNpc2lvbiB8fCA1KTtcblxuICAvLyBDb29yZGluYXRlcyBoYXZlIHZhcmlhYmxlIGxlbmd0aCB3aGVuIGVuY29kZWQsIHNvIGp1c3Qga2VlcFxuICAvLyB0cmFjayBvZiB3aGV0aGVyIHdlJ3ZlIGhpdCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcuIEluIGVhY2hcbiAgLy8gbG9vcCBpdGVyYXRpb24sIGEgc2luZ2xlIGNvb3JkaW5hdGUgaXMgZGVjb2RlZC5cbiAgd2hpbGUgKGluZGV4IDwgc3RyLmxlbmd0aCkge1xuXG4gICAgLy8gUmVzZXQgc2hpZnQsIHJlc3VsdCwgYW5kIGJ5dGVcbiAgICBieXRlID0gbnVsbDtcbiAgICBzaGlmdCA9IDA7XG4gICAgcmVzdWx0ID0gMDtcblxuICAgIGRvIHtcbiAgICAgIGJ5dGUgPSBzdHIuY2hhckNvZGVBdChpbmRleCsrKSAtIDYzO1xuICAgICAgcmVzdWx0IHw9IChieXRlICYgMHgxZikgPDwgc2hpZnQ7XG4gICAgICBzaGlmdCArPSA1O1xuICAgIH0gd2hpbGUgKGJ5dGUgPj0gMHgyMCk7XG5cbiAgICBsYXRpdHVkZV9jaGFuZ2UgPSAoKHJlc3VsdCAmIDEpID8gfihyZXN1bHQgPj4gMSkgOiAocmVzdWx0ID4+IDEpKTtcblxuICAgIHNoaWZ0ID0gcmVzdWx0ID0gMDtcblxuICAgIGRvIHtcbiAgICAgIGJ5dGUgPSBzdHIuY2hhckNvZGVBdChpbmRleCsrKSAtIDYzO1xuICAgICAgcmVzdWx0IHw9IChieXRlICYgMHgxZikgPDwgc2hpZnQ7XG4gICAgICBzaGlmdCArPSA1O1xuICAgIH0gd2hpbGUgKGJ5dGUgPj0gMHgyMCk7XG5cbiAgICBsb25naXR1ZGVfY2hhbmdlID0gKChyZXN1bHQgJiAxKSA/IH4ocmVzdWx0ID4+IDEpIDogKHJlc3VsdCA+PiAxKSk7XG5cbiAgICBsYXQgKz0gbGF0aXR1ZGVfY2hhbmdlO1xuICAgIGxuZyArPSBsb25naXR1ZGVfY2hhbmdlO1xuXG4gICAgY29vcmRpbmF0ZXMucHVzaChbbG5nIC8gZmFjdG9yLCBsYXQgLyBmYWN0b3JdKTtcbiAgfVxuICByZXR1cm4gY29vcmRpbmF0ZXM7XG59XG4iLCJpbXBvcnQgSFRNTFdpZGdldHMgZnJvbSAnLi9nbG9iYWwvaHRtbHdpZGdldHMnO1xuaW1wb3J0IHsgaW5pdGlhbGlzZV9tYXB9IGZyb20gJy4vbW9kdWxlcy91dGlsaXRpZXMuanMnO1xuXG5cbi8vIHJlZmVyZW5jZVxuLy8gaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1JQ1lMT1p1Rk16OFxuXG4vLyByb2xsdXAgY29tbWFuZFxuLy8gLi9ub2RlX21vZHVsZXMvLmJpbi9yb2xsdXAgLWNcblxuLy8gYmFiZWwgcmNcbi8vIG5wbSBpbnN0YWxsIC0tc2F2ZS1kZXYgYmFiZWwtcHJlc2V0LWVzMjAxNS1yb2xsdXBcblxuSFRNTFdpZGdldHMud2lkZ2V0KHtcblxuICBuYW1lOiAnbWFwZGVjaycsXG4gIHR5cGU6ICdvdXRwdXQnLFxuXG4gIGZhY3Rvcnk6IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7XG5cbiAgICAvLyBUT0RPOiBkZWZpbmUgc2hhcmVkIHZhcmlhYmxlcyBmb3IgdGhpcyBpbnN0YW5jZVxuICAgIHJldHVybiB7XG5cbiAgICAgIHJlbmRlclZhbHVlOiBmdW5jdGlvbih4KSB7XG5cbiAgICAgIFx0d2luZG93LnBhcmFtcyA9IFtdO1xuICAgICAgXHR3aW5kb3cucGFyYW1zLnB1c2goeyAnbWFwX2lkJyA6IGVsLmlkIH0pO1xuXG4gICAgICBcdHdpbmRvd1tlbC5pZCArICdsYXllcnMnXSA9IFtdOyAvLyBrZWVwIHRyYWNrIG9mIGxheWVycyBmb3Igb3ZlcmxheWluZyBtdWx0aXBsZVxuICAgICAgXHQvLyBuZWVkcyB0byBiZSBhbiBhcnJheSBiZWNhdXNlIC5wcm9wcyB0YWtlcyBhbiBhcnJheSBvZiBsYXllcnNcblxuICAgICAgICB2YXIgbWFwRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWwuaWQpO1xuICAgICAgICBtYXBEaXYuY2xhc3NOYW1lID0gJ21hcGRlY2ttYXAnO1xuXG4gICAgICAgIHZhciB0b29sdGlwZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRvb2x0aXBkaXYuaWQgPSAndG9vbHRpcCc7XG4gICAgICAgIG1hcERpdi5hcHBlbmRDaGlsZCh0b29sdGlwZGl2KTtcblxuICAgICAgICAvLyBJTklUSUFMIFZJRVdcbiAgICAgICAgd2luZG93W2VsLmlkICsgJ0lOSVRJQUxfVklFV19TVEFURSddID0ge1xuICAgICAgICBcdGxvbmdpdHVkZTogeC5sb2NhdGlvblswXSxcbiAgICAgICAgXHRsYXRpdHVkZTogeC5sb2NhdGlvblsxXSxcbiAgICAgICAgXHR6b29tOiB4Lnpvb20sXG4gICAgICAgIFx0cGl0Y2g6IHgucGl0Y2hcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdFx0ZGVja2dsID0gbmV3IGRlY2suRGVja0dMKHtcbiAgICAgICAgICBcdG1hcGJveEFwaUFjY2Vzc1Rva2VuOiB4LmFjY2Vzc190b2tlbixcblx0XHRcdCAgICAgIGNvbnRhaW5lcjogZWwuaWQsXG5cdFx0XHQgICAgICBtYXBTdHlsZTogeC5zdHlsZSxcblx0XHRcdCAgICAgIGluaXRpYWxWaWV3U3RhdGU6IHdpbmRvd1tlbC5pZCArICdJTklUSUFMX1ZJRVdfU1RBVEUnXSxcblx0XHRcdCAgICAgIGxheWVyczogW10sXG5cdFx0XHQgICAgICAvL29uTGF5ZXJIb3Zlcjogc2V0VG9vbHRpcFxuXHRcdFx0ICB9KTtcblxuXHRcdFx0ICAgIHdpbmRvd1tlbC5pZCArICdtYXAnXSA9IGRlY2tnbDtcblx0XHRcdCAgICBpbml0aWFsaXNlX21hcChlbCwgeCk7XG4gICAgICB9LFxuXG4gICAgICByZXNpemU6IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQpIHtcblxuICAgICAgICAvLyBUT0RPOiBjb2RlIHRvIHJlLXJlbmRlciB0aGUgd2lkZ2V0IHdpdGggYSBuZXcgc2l6ZVxuICAgICAgfVxuXG4gICAgfTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGNoYW5nZV9sb2NhdGlvbiggbWFwX2lkLCBsb2NhdGlvbiwgZHVyYXRpb24sIHRyYW5zaXRpb24sIHpvb20gKSB7XG5cblx0d2luZG93W21hcF9pZCArICdtYXAnXS5zZXRQcm9wcyh7XG4gICAgdmlld1N0YXRlOiB7XG4gICAgICBsb25naXR1ZGU6IGxvY2F0aW9uWzBdLFxuICAgICAgbGF0aXR1ZGU6IGxvY2F0aW9uWzFdLFxuICAgICAgem9vbTogem9vbSxcbiAgICAgIHBpdGNoOiAwLFxuICAgICAgYmVhcmluZzogMCxcbiAgICAgIHRyYW5zaXRpb25JbnRlcnBvbGF0b3I6IHRyYW5zaXRpb24gPT09IFwiZmx5XCIgPyBuZXcgZGVjay5GbHlUb0ludGVycG9sYXRvcigpIDogbmV3IGRlY2suTGluZWFySW50ZXJwb2xhdG9yKCksXG4gICAgICB0cmFuc2l0aW9uRHVyYXRpb246IGR1cmF0aW9uXG4gICAgfSxcbiAgfSk7XG59XG5cbi8vIGZvbGxvd2luZzogaHR0cHM6Ly9jb2RlcGVuLmlvL3Zpcy1nbC9wZW4vcExMUXBOXG4vLyBhbmQ6IGh0dHBzOi8vYmV0YS5vYnNlcnZhYmxlaHEuY29tL0BwZXNzaW1pc3RyZXNzL2RlY2stZ2wtZ2VvanNvbmxheWVyLWV4YW1wbGVcbmZ1bmN0aW9uIHVwZGF0ZVRvb2x0aXAoe3gsIHksIG9iamVjdH0pIHtcbiAgY29uc3QgdG9vbHRpcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sdGlwJyk7XG4gIGlmIChvYmplY3QpIHtcbiAgXHRpZihvYmplY3QudG9vbHRpcCA9PT0gdW5kZWZpbmVkKSB7XG4gIFx0XHRyZXR1cm47XG4gIFx0fVxuICAgIHRvb2x0aXAuc3R5bGUudG9wID0gYCR7eX1weGA7XG4gICAgdG9vbHRpcC5zdHlsZS5sZWZ0ID0gYCR7eH1weGA7XG4gICAgdG9vbHRpcC5pbm5lckhUTUwgPSBgPGRpdj4ke29iamVjdC50b29sdGlwfTwvZGl2PmA7XG4gIH0gZWxzZSB7XG4gICAgdG9vbHRpcC5pbm5lckhUTUwgPSAnJztcbiAgfVxufVxuXG5pZiAoSFRNTFdpZGdldHMuc2hpbnlNb2RlKSB7XG5cbiAgU2hpbnkuYWRkQ3VzdG9tTWVzc2FnZUhhbmRsZXIoXCJtYXBkZWNrbWFwLWNhbGxzXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICB2YXIgaWQgPSBkYXRhLmlkLCAgIC8vIHRoZSBkaXYgaWQgb2YgdGhlIG1hcFxuICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCksXG4gICAgICBtYXAgPSBlbCxcbiAgICAgIGNhbGwgPSBbXSxcbiAgICAgIGkgPSAwO1xuXG4gICAgaWYgKCFtYXApIHtcbiAgICAgIC8vY29uc29sZS5sb2coXCJDb3VsZG4ndCBmaW5kIG1hcCB3aXRoIGlkIFwiICsgaWQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhLmNhbGxzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgIGNhbGwgPSBkYXRhLmNhbGxzW2ldO1xuXG4gICAgICAvL3B1c2ggdGhlIG1hcElkIGludG8gdGhlIGNhbGwuYXJnc1xuICAgICAgY2FsbC5hcmdzLnVuc2hpZnQoaWQpO1xuXG4gICAgICBpZiAoY2FsbC5kZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgU2hpbnkucmVuZGVyRGVwZW5kZW5jaWVzKGNhbGwuZGVwZW5kZW5jaWVzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHdpbmRvd1tjYWxsLm1ldGhvZF0pIHtcbiAgICAgICAgd2luZG93W2NhbGwubWV0aG9kXS5hcHBseSh3aW5kb3dbaWQgKyAnbWFwJ10sIGNhbGwuYXJncyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwiVW5rbm93biBmdW5jdGlvbiBcIiArIGNhbGwubWV0aG9kKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufVxuXG5cblxuXG4iXSwibmFtZXMiOlsid2luZG93IiwiSFRNTFdpZGdldHMiLCJpbml0aWFsaXNlX21hcCIsImVsIiwieCIsImNhbGxzIiwidW5kZWZpbmVkIiwibGF5ZXJDYWxscyIsImxlbmd0aCIsImFyZ3MiLCJ1bnNoaWZ0IiwiaWQiLCJmdW5jdGlvbnMiLCJhcHBseSIsIndpZGdldCIsIm5hbWUiLCJ0eXBlIiwiZmFjdG9yeSIsIndpZHRoIiwiaGVpZ2h0IiwicmVuZGVyVmFsdWUiLCJwYXJhbXMiLCJwdXNoIiwibWFwRGl2IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNsYXNzTmFtZSIsInRvb2x0aXBkaXYiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJsb25naXR1ZGUiLCJsb2NhdGlvbiIsImxhdGl0dWRlIiwiem9vbSIsInBpdGNoIiwiZGVja2dsIiwiZGVjayIsIkRlY2tHTCIsIm1hcGJveEFwaUFjY2Vzc1Rva2VuIiwiYWNjZXNzX3Rva2VuIiwiY29udGFpbmVyIiwibWFwU3R5bGUiLCJzdHlsZSIsImluaXRpYWxWaWV3U3RhdGUiLCJsYXllcnMiLCJyZXNpemUiLCJzaGlueU1vZGUiLCJTaGlueSIsImFkZEN1c3RvbU1lc3NhZ2VIYW5kbGVyIiwiZGF0YSIsIm1hcCIsImNhbGwiLCJpIiwiZGVwZW5kZW5jaWVzIiwicmVuZGVyRGVwZW5kZW5jaWVzIiwibWV0aG9kIl0sIm1hcHBpbmdzIjoiOzs7QUFBQSxzQkFBZUEsT0FBT0MsV0FBdEI7O0VDQ08sU0FBU0MsY0FBVCxDQUF3QkMsRUFBeEIsRUFBNEJDLENBQTVCLEVBQStCOztFQUVyQztFQUNDLE1BQUlBLEVBQUVDLEtBQUYsS0FBWUMsU0FBaEIsRUFBMkI7O0VBRXpCLFNBQUtDLGFBQWEsQ0FBbEIsRUFBcUJBLGFBQWFILEVBQUVDLEtBQUYsQ0FBUUcsTUFBMUMsRUFBa0RELFlBQWxELEVBQWdFOztFQUU5RDtFQUNBSCxRQUFFQyxLQUFGLENBQVFFLFVBQVIsRUFBb0JFLElBQXBCLENBQXlCQyxPQUF6QixDQUFpQ1AsR0FBR1EsRUFBcEM7O0VBRUEsVUFBSVgsT0FBT0ksRUFBRUMsS0FBRixDQUFRRSxVQUFSLEVBQW9CSyxTQUEzQixDQUFKLEVBQTJDOztFQUV6Q1osZUFBT0ksRUFBRUMsS0FBRixDQUFRRSxVQUFSLEVBQW9CSyxTQUEzQixFQUFzQ0MsS0FBdEMsQ0FBNENiLE9BQU9HLEdBQUdRLEVBQUgsR0FBUSxLQUFmLENBQTVDLEVBQW1FUCxFQUFFQyxLQUFGLENBQVFFLFVBQVIsRUFBb0JFLElBQXZGO0VBRUQsT0FKRDtFQU9EO0VBQ0Y7RUFDRjs7RUNoQkQ7RUFDQTs7RUFFQTtFQUNBOztFQUVBO0VBQ0E7O0FBRUFSLGdCQUFZYSxNQUFaLENBQW1COztFQUVqQkMsUUFBTSxTQUZXO0VBR2pCQyxRQUFNLFFBSFc7O0VBS2pCQyxXQUFTLGlCQUFTZCxFQUFULEVBQWFlLEtBQWIsRUFBb0JDLE1BQXBCLEVBQTRCOztFQUVuQztFQUNBLFdBQU87O0VBRUxDLG1CQUFhLHFCQUFTaEIsQ0FBVCxFQUFZOztFQUV4QkosZUFBT3FCLE1BQVAsR0FBZ0IsRUFBaEI7RUFDQXJCLGVBQU9xQixNQUFQLENBQWNDLElBQWQsQ0FBbUIsRUFBRSxVQUFXbkIsR0FBR1EsRUFBaEIsRUFBbkI7O0VBRUFYLGVBQU9HLEdBQUdRLEVBQUgsR0FBUSxRQUFmLElBQTJCLEVBQTNCLENBTHdCO0VBTXhCOztFQUVDLFlBQUlZLFNBQVNDLFNBQVNDLGNBQVQsQ0FBd0J0QixHQUFHUSxFQUEzQixDQUFiO0VBQ0FZLGVBQU9HLFNBQVAsR0FBbUIsWUFBbkI7O0VBRUEsWUFBSUMsYUFBYUgsU0FBU0ksYUFBVCxDQUF1QixLQUF2QixDQUFqQjtFQUNBRCxtQkFBV2hCLEVBQVgsR0FBZ0IsU0FBaEI7RUFDQVksZUFBT00sV0FBUCxDQUFtQkYsVUFBbkI7O0VBRUE7RUFDQTNCLGVBQU9HLEdBQUdRLEVBQUgsR0FBUSxvQkFBZixJQUF1QztFQUN0Q21CLHFCQUFXMUIsRUFBRTJCLFFBQUYsQ0FBVyxDQUFYLENBRDJCO0VBRXRDQyxvQkFBVTVCLEVBQUUyQixRQUFGLENBQVcsQ0FBWCxDQUY0QjtFQUd0Q0UsZ0JBQU03QixFQUFFNkIsSUFIOEI7RUFJdENDLGlCQUFPOUIsRUFBRThCO0VBSjZCLFNBQXZDOztFQU9BLFlBQU1DLFNBQVMsSUFBSUMsS0FBS0MsTUFBVCxDQUFnQjtFQUM1QkMsZ0NBQXNCbEMsRUFBRW1DLFlBREk7RUFFOUJDLHFCQUFXckMsR0FBR1EsRUFGZ0I7RUFHOUI4QixvQkFBVXJDLEVBQUVzQyxLQUhrQjtFQUk5QkMsNEJBQWtCM0MsT0FBT0csR0FBR1EsRUFBSCxHQUFRLG9CQUFmLENBSlk7RUFLOUJpQyxrQkFBUTtFQUNSO0VBTjhCLFNBQWhCLENBQWY7O0VBU0Q1QyxlQUFPRyxHQUFHUSxFQUFILEdBQVEsS0FBZixJQUF3QndCLE1BQXhCO0VBQ0FqQyx1QkFBZUMsRUFBZixFQUFtQkMsQ0FBbkI7RUFDQSxPQXBDSTs7RUFzQ0x5QyxjQUFRLGdCQUFTM0IsS0FBVCxFQUFnQkMsTUFBaEIsRUFBd0I7O0VBRTlCO0VBQ0Q7O0VBekNJLEtBQVA7RUE0Q0Q7RUFwRGdCLENBQW5COztFQXNGQSxJQUFJbEIsY0FBWTZDLFNBQWhCLEVBQTJCOztFQUV6QkMsUUFBTUMsdUJBQU4sQ0FBOEIsa0JBQTlCLEVBQWtELFVBQVVDLElBQVYsRUFBZ0I7O0VBRWhFLFFBQUl0QyxLQUFLc0MsS0FBS3RDLEVBQWQ7RUFBQTtFQUNFUixTQUFLcUIsU0FBU0MsY0FBVCxDQUF3QmQsRUFBeEIsQ0FEUDtFQUFBLFFBRUV1QyxNQUFNL0MsRUFGUjtFQUFBLFFBR0VnRCxPQUFPLEVBSFQ7RUFBQSxRQUlFQyxJQUFJLENBSk47O0VBTUEsUUFBSSxDQUFDRixHQUFMLEVBQVU7RUFDUjtFQUNBO0VBQ0Q7O0VBRUQsU0FBS0UsSUFBSSxDQUFULEVBQVlBLElBQUlILEtBQUs1QyxLQUFMLENBQVdHLE1BQTNCLEVBQW1DNEMsR0FBbkMsRUFBd0M7O0VBRXRDRCxhQUFPRixLQUFLNUMsS0FBTCxDQUFXK0MsQ0FBWCxDQUFQOztFQUVBO0VBQ0FELFdBQUsxQyxJQUFMLENBQVVDLE9BQVYsQ0FBa0JDLEVBQWxCOztFQUVBLFVBQUl3QyxLQUFLRSxZQUFULEVBQXVCO0VBQ3JCTixjQUFNTyxrQkFBTixDQUF5QkgsS0FBS0UsWUFBOUI7RUFDRDs7RUFFRCxVQUFJckQsT0FBT21ELEtBQUtJLE1BQVosQ0FBSixFQUF5QjtFQUN2QnZELGVBQU9tRCxLQUFLSSxNQUFaLEVBQW9CMUMsS0FBcEIsQ0FBMEJiLE9BQU9XLEtBQUssS0FBWixDQUExQixFQUE4Q3dDLEtBQUsxQyxJQUFuRDtFQUNELE9BRkQ7RUFLRDtFQUNGLEdBOUJEO0VBK0JEOzs7OyJ9
